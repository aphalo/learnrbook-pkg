<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Pedro J. Aphalo" />

<meta name="date" content="2021-07-04" />

<title>Annotations are not data labels</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Annotations are not data labels</h1>
<h3 class="subtitle">On how ‘ggpmisc’ extends the grammar of graphics</h3>
<h4 class="author">Pedro J. Aphalo</h4>
<h4 class="date">2021-07-04</h4>


<div id="TOC">
<ul>
<li><a href="#data-labels-annotations-and-insets">Data labels, annotations and insets</a></li>
<li><a href="#annotations-in-ggplot2">Annotations in ‘ggplot2’</a></li>
<li><a href="#extending-ggplot2">Extending ‘ggplot2’</a></li>
<li><a href="#when-to-use-annotations-and-insets">When to use annotations and insets</a></li>
<li><a href="#thoughts-for-the-future">Thoughts for the future</a></li>
<li><a href="#list-of-references">List of references</a></li>
</ul>
</div>

<div id="data-labels-annotations-and-insets" class="section level2">
<h2>Data labels, annotations and insets</h2>
<p><em>Data labels</em> add textual information directly related to individual data points (shown as glyphs). Text position in this case is dependent on the scales used to represent data points. Text is usually displaced so that it does not occlude the glyph representing the data point and when the link to the data point is unclear, this link is signaled with a line segment or arrow. Data labels are distinct from annotations but instead contribute to the representation of data on a plot or map.</p>
<p><em>References</em> are lines, shading or marks used to help the reading of a plot. These elements are used to highlight specific values on an axis or a region in a plot. They, like data labels, are positioned relative to the scales used for data. The position of data labels and lines, glyphs or shading used as reference cannot be altered by the designer of a plot, as the position conveys information. I will use the term <em>data labels</em> irrespective if the “labels” are textual or graphical, like icons and small plots and simple tables linked to data points or map features.</p>
<p>According to Koponen and Hildén (2019), “[in a statistical chart] annotations can be used to draw reader attention to relevant detail”. These authors use as an example a text box in a plot to highlight a data point that is off-scale and has been “squeezed” to a position immediately outside the plotting area.</p>
<p><em>Annotations</em> differ from data labels, in that their position is decoupled from their meaning. Insets can be thought as larger, but still self-contained annotations. In most cases the reading of inset tables and plots depends only weakly on the plot or map in which they are included.</p>
<p>In the case of annotations and insets the designer of a data visualization has the freedom to locate them anywhere, as long they do not occlude features used to describe data. I will use the term <em>annotation</em> irrespective if the “labels” are textual or graphical. Insets are similar to annotations, but the term <em>inset</em> is used when an annotation’s graphical or textual element is complex and occupies more space within the plotting area. Insets can be moved from within the main plotting area to being adjacent to it, e.g., as a smaller panel, without any loss of meaning .</p>
<p>That the position of annotations and insets is independent of the plotted data cannot be expressed using the grammar of graphics (GG) as implemented in package ‘ggplot2’.</p>
</div>
<div id="annotations-in-ggplot2" class="section level2">
<h2>Annotations in ‘ggplot2’</h2>
<p>In <em>The Layered Grammar of Graphics</em> (Wickham 2000) as implemented in package ‘ggplot2’ (Wickham et al. 2016) annotations are “second class” features. As layers they behave differently than data layers: Only constant values can be mapped to aesthetics and do no support faceting into panels. In escence <code>annotate()</code> disconnects the resulting plot elements from the data source and facetting, but not from the scales used to graphically display the data values.</p>
<p>From the data visualization perspective the main practical and conceptual difference between data labels and annotations is in the scales used to position them within the plotting area. Instead of using an <code>annotate()</code> function that deviates from the grammar of graphics to implement annotations, we could retain the use of the grammar of graphics for annotations but add support of native plot coordinates (npc). Support of annotations done in this way would allow “annotation layers” to behave almost identically to “data layers”, and use the same grammar. The <em>x</em> and <em>y</em> position aesthetics used for data could be supplemented with pseudo-aesthetics without any translation relative to the native plotting coordinates of the plotting area or viewport. Doing so, would allow the graphic design flexibility conceptually inherent to annotations within a user-friendly syntax.</p>
</div>
<div id="extending-ggplot2" class="section level2">
<h2>Extending ‘ggplot2’</h2>
<p>Based on this insight, a new approach to adding annotations and insets was implemented in package ‘ggpmisc’ (&gt;= 0.3.1) through two new <em>x</em> and <em>y</em> pseudo-aesthetics, <em>npcx</em> and <em>npcy</em>, and corresponding dumb scales and various geometries that make use of them. These scales and geometries were implemented as an extension to package ‘ggplot2’.</p>
<p>Before showing how this works in practice, we load the package and set an uncluttered theme as default.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpmisc)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>()))</span></code></pre></div>
<p>Native plot coordinates have range 0..1. However, the “npc” geoms also recognize some positions by name with the same text strings as used for text justification in ‘ggplot2’. The default justification is <code>&quot;inward&quot;</code>, as this protects from clipping at the edges the plotting area irrespective the arguments passed to the <code>witdth</code> and <code>height</code> parameters of R’s graphic devices.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="fu">factor</span>(cyl), mpg)) <span class="sc">+</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_npc</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="st">&quot;left&quot;</span>, <span class="st">&quot;left&quot;</span>),</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">y =</span> <span class="fu">c</span>(<span class="st">&quot;top&quot;</span>, <span class="st">&quot;bottom&quot;</span>),</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;Most</span><span class="sc">\n</span><span class="st">efficient&quot;</span>,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>                                            <span class="st">&quot;Least</span><span class="sc">\n</span><span class="st">efficient&quot;</span>)),</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">npcx =</span> x, <span class="at">npcy =</span> y, <span class="at">label =</span> label),</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">3</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>The advantage of this approach becomes apparent when the limits of the <em>y</em> scale are unknown or vary. When a script or user defined plotting function sets the scale limits based on the input data, in the absence of the extensions proposed here, setting annotations consistently within the plotting area becomes laborious. The example below, shows how the annotations remain at the desired position when the <em>y</em> scale limts are expanded.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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I1BII1BII1BII1BII1BII1Bok3lgeYNhgF8ECmkECmkECmkEClcskqCMbSZII1BII1Bo4xoUWESgkEagkEagkEagkEagkEagkEagkEagkEagkEagkEagkEagkEagkEagkEagkEagkEagkEagkEagkEagkEagcMV3dUIZ3xcPacKB9l91jBm+rh9cLw5DeegGelN/2jG3pyfm6tniMJSI6jXohyf/SGbQ4dvOeCadGwb45XyK7x9dm+GbMzvE8v+VAWaDQG8OpoHODgP8yjCDzg4D/HIOlGtQFME50NvTY1bxyB37oJDGnSRII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BI8xNoXLtcenzw9fLjwAPyDfSh48ADvAbai6KKMV37ftSMov3k3SMKxSZ8BmrfnzeS94Ov2r2KSd4zg2JDPgNNJtBk2jRxNdppJe8qnOKxMa+BVuzHvd324HnL2E4bBIoNeT3FP26Nmo0k095Oq5vEer5PoNiQp0CrkV0ZpYukwWH0q8OGOY+SBdLgkEUSNsJGPaQRKKQRKKQRKKQRKKQRKKQRKKQRKKR5DXTUjBrJ24vJ/aP5+0g8GwoHXgO1RT54d5PbnnDgKdDpTc7dH5K372uXcTXatQ/bpcfjLw6jCs+GwoW/h0XOG9MZNK59et4y3Upcuxg/IbrX5tlQuPET6PRJ0GmgF5MHmD+mx5NDo3ctAoUDT4GmT4IuCbQyOUygcOMe6PB1/eB6cdgDxk+Czp/ie48uahfpcQKFM+dAb09PzNWzxWEPGX+73F2gC4ukNFCeDYUD50CHbzum/6qzMAzwyznQ/tG1Gb45s0Msv18VMOEc6M3BNNDZYYBfGWbQ2WGAX1yDQtoGq/jjDVbxwC/Dzz4o8AvheVBII1BII1BII1BII1BII1BII1BII1BII1BIyxookI9sgRYh+FmbF7AFAvWPF7AFAvWPF7CFAAJFmREopBEopBEopBEopOkHan+0ScBuT+tPztZ/mq7+y/rTzvpP80U/0Kt60IF+OEl/tECw7LecXxX4AuQD7f/+u5ADtd+1HbT05yIU+CLUA7392z+DPsX3j/4e9imeGXS1q+Owr0H7L0/SSShcc992nj/xQJP/t4EHOveTgwLU//bM3BS4ShIP9KpuHRf9ZWQ3/EPggc7/8Lj8iQdqgt9m+hD4KZ4ZdJ3AA00u4YrcRtzeTb3QVZ5+oCg1AoU0AoU0AoU0AoU0AoU0At1eN9ppLR77778Xj9i/gm9e/Lg1eP7ZSMwh0K0NDhfLS9tbPNStLPukHn/t3moEurUlMS45tmSutJ/0+byKOQS6rbia/j2k1fQvIk+Cm/5uf/Kxiff+FO22u3aqnBw5t5Npt5JWzBS6GoFuzXaWnua7u+1Rs5J+PJ4cK+lbXK3YNNN6x3/a223bqTMNdNn8i3sEujWb2M+X4w+muaWXl0mG9l1cbUwuVKd/mia8105/u+wKFvcIdGvj7HrJKX6nlUZpZtY/02jTDqd/ahdMyT/pH6RTKx5EoFsbn+J3WvYDx0DjvR+bDQJ1QaBbu4uxtzN/ire7o/YUfxfo3fXmqPlir204xTsg0K1NY4yrO63pwshmd7dISrM8nyyS7Jvd269MemWRtBqBbi1N7Dy5Av1LWmW6kZT8vnK3zTS+Rp3ZZrJ7U9MJtcs200oEmpP5jfpkDT/+gI36NQg0L3O3OrvTlRH79GsQaF5m5sq4Os2Sh0XWIVBII1BII1BII1BII1BII1BII1BI+x8wuNKhcGwZBwAAAABJRU5ErkJggg==" style="display: block; margin: auto;" /></p>
<p>To support the existing syntax for annotations using the new geometries, function <code>ggplot2::annotate()</code> is overridden when package ‘ggpmisc’ is loaded. The new definition adds support for the new pseudo-aesthetics <em>npcx</em> and <em>npcy</em> retaining its original ‘ggplot2’ behaviour in all other respects.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="fu">factor</span>(cyl), mpg)) <span class="sc">+</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text_npc&quot;</span>,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">npcx =</span> <span class="fu">c</span>(<span class="st">&quot;left&quot;</span>, <span class="st">&quot;left&quot;</span>),</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">npcy =</span> <span class="fu">c</span>(<span class="st">&quot;top&quot;</span>, <span class="st">&quot;bottom&quot;</span>),</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;Most</span><span class="sc">\n</span><span class="st">efficient&quot;</span>,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;Least</span><span class="sc">\n</span><span class="st">efficient&quot;</span>),</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAGACAMAAABFpiBcAAABAlBMVEUAAAAAADoAAGYAOpAAZmYAZrYzMzM6AAA6ADo6AGY6Ojo6OmY6OpA6ZmY6ZrY6kLY6kNtNTU1NTW5NTY5NbqtNjshmAABmADpmAGZmOpBmZpBmkJBmtv9uTU1uTW5uTY5ubo5ubqtuq+SOTU2OTW6OTY6Obk2ObquOyP+QOgCQOjqQOmaQZjqQkDqQkJCQ27aQ29uQ2/+rbk2rbm6rbo6rjk2ryKur5OSr5P+2ZgC2kGa225C22/+2/7a2/9u2///Ijk3I///bkDrbkGbbtmbb25Db/7bb/9vb///kq27k////tmb/yI7/25D/27b/29v/5Kv//7b//8j//9v//+T///+OoQr4AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAMc0lEQVR4nO3dC3caxwGG4ZVcQtQqqVaW5VywHUtOi+LekNMUNU0QNEqFgJbb/P+/0p0FJIERDMuZ5Zuz73MqJK88p3D8ZnZnd5EiAwiLdv0EgFUIFNIIFNIIFNJWBNqN4+dNY9rx5DOwA08H2n/TNO0XxlxX83s2wILVu/gk0vGH+qMNnwD5cAo0mUGH58kuvnof5zb/MQDOXALtvzqum/7runmYRQkU+XCbQYfvJmXeH4cSKPLhFuisTAJFztYH2j25szOo/TT+fnaaiUCRD4cZtB3HyTHo7NP8MMAvx138U8MAvwgU0ggU0ggU0ggU0ggU0sIJNIq4Z7WAggk0iii0iAgU0ggU0oIJlGPQYvITaK9cMaa133i8bfDl7Wb/H4C3QH/7uRl997u5QHuHBIqNeQr08C+3g6/eN0wrio7M6CJ5TB6eUSg25SvQf9Y6v3/f6B00Bi9rnZIZfNFgBkUGvgL9pfLvv71vJGmaq0qvHJXYxSMTX4H++tX7n2eB2kVTVCFQZOAr0P/86fPRbBffspkeESgy8BXobetoNFkkJRPoVZQskAanLJKwsXBO1KOQCBTSCBTSCBTSCBTSCBTSwgmU2+0KKZhAuWG5mAgU0rwGOrqIKsnH19OLnPMXOze8gZlAi8lroLbIJy/Bb3ptnj4LyVOgnSgqmcFptP9T8vHj4W2vHO3bO0LT7b3PTqMSNzDDhbebRextdtMZtHf468uaaZV6hzfpdnuPEzcww4mfQDv2gPHoIdCbNMbe4S/p9mTT6LsagcKBp0BL6aePAy1NNxMo3HjaxX9aG10s7OI7z24Ob9LtBApnPhdJD4EuLJLSQLmBGQ6COVGPYiJQSCNQSCNQSCNQSCNQSCNQSCNQSCNQSCNQSCNQSCNQSCNQSCNQSCNQSAsnUN7VWUjBBMr74ouJQCGNQCHNIdBuHD9vGjM8j0/uFofliD4LaX2g/TdN035hxpdV+2lhGOCX2y4+iXT4bTNtdX4Y4JdboMnU2X97Z4bv6naI5f2JAZZLoP1Xx3XTPZkF+ngY4JfbDJqU+TCDPh4G+OV4mum6yjEodmF9oNN9+/jyjFU8cucwg7bjODkG3fl5UBRSMFeSUEwECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmnhBMrPqC+kYALlt3wUE4FCGoFCWjCBcgxaTOEEikIiUEgjUEgjUEgjUEgjUEgjUEgjUEgjUEgjUEgjUEgLJ1CuxRdSMIFyN1MxESikESikBRMox6DFFE6gKCQChTQChTQChTQChTQChTQChTSHQPuv4rhqTDuO4+fNhWGAX+sDHb6rm/7rurmuLhkG+LU+0O6L5OG6Ov5QXzIM8MvtGDSZRYfncbqnT4ZYvp8XkHIKdHx5lu7lH2ZRAkU+XAIdnp9Nv7o/DiVQ5MNpFX+/PCJQ5Gx9oNM+uyd3Zvw9p5mQr/WB2vOfdnmUfD6+X8gTKPIRzpUkblgupGAC5S0fxUSgkEagkBZMoByDFlM4gaKQCBTSCBTSCBTSCBTSCBTSCBTSCBTSCBTSCBTSCBTSCBTSCBTSlgU6OI2mSuuGAX4tnUFb+w2b6dHo4qlCCRT5WD6DVuynzn6jY0tdNQzwK5xAuWG5kFbu4k3r2e3qYfnhLR/FtHwV37E1VExrr7ZmWH4ItJiCOc1EoMUUTKAcgxbT8kBbk138+mGAX6sXSWuHAX6tPs20dhjgF4FC2tJdfMeeXmIXDwGrbxaJhK4koZDCOc2EQiJQSFsaaK+8cv9uCBR5WRbo07eBfjQM8GvFaSaXYYBfy2dQxUC5Fl9Iy8+Drjj6nB+WH+5mKqZgFknhBxr689+N5bv4FdeQ5oflJ/hAg38BuxHMIin4f9/gX8BuBLNICv7fN/gXsBvLj0EP9BZJ4R/CBf8CdmLVzSJSi6TwEWgWXIvPC7v4TAg0LwSaCYHmhUAzIdDc0GcWBAppBAppBAppBAppBAppBAppBAppDoH2X8Vx1ZjheXxytzgM8Gt9oMN3ddN/XR9fVk37xeIwwK/1gXZfJA/X1eG3TdN/01wYBvjldgyazKL9t3fpZJoMsbw/McByCnR8eWa6J7NAHw+DO67FZ+ES6PD8LFkqvSXQrXA3UyZOq/hkDW84Bt0SgWayPtBJn+lunlX8Fgg0k/WBtmOrynnQbdFnFlxJgjQChTQCzU3wu/idvAACzUvwi6TdvAACzQuBZkKgeSHQTAg0N4H3yTEo8DEChStmUCjjGBTSCBTSCBTaOAYFFhEopBEopBFoboK/krQTBJqX4K/F7waB5oVAMyHQvBBoJgSaG/rMgkDzwgyaCYHmhUAzIdC8EGgmBJob+syCQCGNQOGKu5mgjPtBIY1AIY1AoY1jUGARgUIagUIagUIagUIagUIagUIagcIV50GhjCtJkEagkEag0MYxKLCIQCGNQOGKXTyUsUiCNAKFNAKFNo5BoYwZFNIIFNIIFNo4BoUy4Rm0/6ZpTDuO4+fNhWEoDt1Au2mY19Ulw1AcsoFeH/+QzKDjD/Ulw1AcsoFOdvHD82QXn06in1jenxjUiAfaf11/NIsSaPGIB5q6Pw4l0ALSPc1EoJCfQbsnd2b8PaeZiks8UHse9Ph+IU+gxSMc6NPDUCC6x6BPD0OBECiUsYuHNAKFNAKFNo5BgUUECmkECmkECmkECmkECmkECmkECmkEClecqIcyLnVCGoFCGoFCG8egwCIChTQChTQChTQChTQChTQChTQChTQChTQ/gfYOb5duH3y5fDvwhHwDfWo78ASvgXaiqGRMyz6OLqLoKHl4RqHYhM9A7eNVJXkcfNHolEzyyAyKDfkMtGPvzzoyvXK0V0seSuzisTGvgZbs1539xuBlzdhOKwSKDXndxX9aG11Ukkw7e7VWEuvVEYFiQ54CLUd2ZZQukgan0W9OK+YqShZIg1MWSdgIJ+ohjUAhjUAhjUAhjUAhjUAhjUAhjUAhzWugo4uoknx8Pb1+NH8diXtD4cBroLbIJ69uctkTDjwFOrvIuf9T8vHj4W2vHO3bm+3S7b3PTqMS94bChb+bRa4qsxm0d/jry5pplXqHN5M7RA8a3BsKN34Cnd0JOgv0ZnoD8y/p9mTT6LsagcKBp0DTO0GXBFqabiZQuPG0i0/vBJ3fxXee3RzepNsJFM58LpIeAl1YJKWBcm9oaPgBtlDGjwCHNAKFNOFA+2+axgzP45O7xWEoENlj0G78vGnGl1XTfrE4DPDLIdDr4x+SGXT4bXMyk84NA/xy3sX3396Z4bu6HWL5f2aA2SDQ7sks0MfDAL8yzKCPhwF+OQfKMSh2wTnQ8eUZq3jkjvOgkMaVJEgjUEgjUEgjUEjLGiiQj2yB7kLwszYvYAsE6h8vYAsE6h8vYAsBBIoiI1BII1BII1BII1BI0w/UvmsvYOPL+Li+/q/p6r+y753cGf1A23HQgV5X03fNBMu+m6K9wxcgH2j/mz+EHKh9Q0LQ0rf87PBFqAc6/vCPoHfx/bd/D3sXzwy6Wvss7GPQ/qtqOgmFa+4dFfkTDzT5tw080Lk3xQao/7puujtcJYkH2o6ts10/jeyGfww80Pmfi5A/8UBN8KeZrgPfxTODrhN4oMkh3C5PI26vG+90lacfKAqNQCGNQCGNQCGNQCGNQCGNQLfXivZqi9v++6/FLfZX8M3rfVobvPxoJOYQ6NYGp4vlpe0tbmqVlv2lDr92bzUC3dqSGJdsWzJX2r/08byKOQS6rV45/T2k5fQXkSfBzf50NP3a9A7+HO03WnaqnG65spNpq5RWzBS6GoFuzXaW7uZb+43RRSn9ejI5ltKPXrlk00zrnXy3s9+wU2ca6LL5Fw8IdGs2sf/dTr6Y5ZYeXiYZ2odeuTI9UJ19N034oJH+cdkRLB4Q6NYm2XWSXfxeLY3SPFr/zKJNO5x91y6Ykv+l30inVjyJQLc22cXv1ewXjoH2Dn6+qBCoCwLd2n2Mnb35Xbw9O2p38feB3h9vji6+PmgYdvEOCHRrsxh75b3abGFks7tfJKVZXk0XSfbDntsvTXtlkbQagW4tTewqOQL9a1pleiIp+XPp/jTT5Bj10Wkme25qNqG2OM20EoHmZP5EfbKGn3zBifo1CDQvc5c6W7OVEefp1yDQvDyaK3vlWZbcLLIOgUIagUIagUIagUIagUIagUIagULa/wGkEYvoJgXoBQAAAABJRU5ErkJggg==" style="display: block; margin: auto;" /></p>
<p>Inset plots can be added with the same syntax using <code>geom_plot_npc()</code>. They can be thought also as being annotations. Here we use <code>annotate()</code> but <code>geom_plot()</code> can be also used directly, in which case the inset plots can be different for each panel.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="fu">factor</span>(cyl), mpg, <span class="at">colour =</span> <span class="fu">factor</span>(cyl))) <span class="sc">+</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_boxplot</span>() <span class="sc">+</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="dv">9</span>) <span class="sc">+</span> </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(wt, mpg, <span class="at">colour =</span> <span class="fu">factor</span>(cyl))) <span class="sc">+</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;plot_npc&quot;</span>, <span class="at">npcx =</span> <span class="st">&quot;left&quot;</span>, <span class="at">npcy =</span> <span class="st">&quot;bottom&quot;</span>, <span class="at">label =</span> p2) <span class="sc">+</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">0</span>, <span class="at">x =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>A simple example with facets, labeling of panels in a traditional way as requiered by some book and journal styles. In this case panel tags within the plotting are at same “npc” location with free scale limits in panels.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(wt, mpg)) <span class="sc">+</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_npc</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">cyl =</span> <span class="fu">levels</span>(<span class="fu">factor</span>(mtcars<span class="sc">$</span>cyl)),</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">label =</span> LETTERS[<span class="fu">seq_along</span>(<span class="fu">levels</span>(<span class="fu">factor</span>(mtcars<span class="sc">$</span>cyl)))],</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">x =</span> <span class="fl">0.90</span>,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">y =</span> <span class="fl">0.95</span>),</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">npcx =</span> x, <span class="at">npcy =</span> y, <span class="at">label =</span> label),</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span><span class="fu">factor</span>(cyl), <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>This approach was first implemented in ‘ggpmisc’ version 0.3.1 released in April 2919. As of version &gt;= 0.3.8, the implementation can be considered fairly stable. However, this implementation is to an extent dependent on undocumented behaviour of ‘ggplot2’ functions, which means that future updates to ‘ggplot2’ can break this functionality.</p>
</div>
<div id="when-to-use-annotations-and-insets" class="section level2">
<h2>When to use annotations and insets</h2>
<p>Package ‘ggpmisc’ adds support for various plot annotations and reference guides. It also adds support for some data labels related to data features. While developing these statistics, it became clear that expanding the grammar of graphics’s support for annotations would simplify the code of these statistics considerably and also more cleanly separate the computations on data from the positioning of annotations.</p>
<p><strong>Table</strong>. Geometries useful for data labels and annotations. Currently implemented <em>ordinary</em> geometries and their <em>npc</em> versions. The rightmost column shows the expected class of the objects mapped to the <code>label</code> aesthetic. When using <code>annotate()</code> to add a single plot, table or grob as an inset, enclosing them in a list is allowed, but not a requirement.</p>
<table>
<thead>
<tr class="header">
<th>Data labels (data coordinates)</th>
<th>Annotations (npc)</th>
<th>Mapped to <code>label</code> aesthetic</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>ggplot2::geom_text()</code></td>
<td><code>geom_text_npc()</code></td>
<td><code>character</code> vector</td>
</tr>
<tr class="even">
<td><code>ggplot2::geom_label()</code></td>
<td><code>geom_label_npc()</code></td>
<td><code>character</code> vector</td>
</tr>
<tr class="odd">
<td><code>geom_plot()</code></td>
<td><code>geom_plot_npc()</code></td>
<td><code>list()</code> of <code>ggplot2::gg</code></td>
</tr>
<tr class="even">
<td><code>geom_table()</code></td>
<td><code>geom_table_npc()</code></td>
<td><code>list()</code> of <code>data.frame</code></td>
</tr>
<tr class="odd">
<td><code>geom_grob()</code></td>
<td><code>geom_grob_npc()</code></td>
<td><code>list()</code> of <code>grid::grob</code></td>
</tr>
</tbody>
</table>
<p>When adding an informative element to a plot, assess whether it is an <em>annotation</em> or a <em>data label</em>. To decide on the best approach, consider if the location of the element is more “naturally” expressed in the original data units or as position relative to the edges or centre of the plotting area. In the second case, prefer the “npc” geoms as you are dealing with <em>annotations</em>, otherwise, use the ordinary geometries as you are dealing with data labels or data points.</p>
</div>
<div id="thoughts-for-the-future" class="section level2">
<h2>Thoughts for the future</h2>
<p>Although we have discussed only scales for <em>x</em> and <em>y</em> aesthetics, the same consideration applies to other aesthetics like <em>colour</em>. It seems generally useful to allow aesthetics to use a different scale for annotations than for data. Defining pseudo-aesthetics for annotations instead of allowing multiple scales for each aesthetic in a plot would add flexibility while still keeping the guarantee that the meaning of aesthetics values remains consistent across all plot elements representing data.</p>
</div>
<div id="list-of-references" class="section level2">
<h2>List of references</h2>
<p>Koponen, J; Hildén, J. (2019) <em>Data visualization handbook</em>. Aalto ARTS books, Espoo. ISBN 978-952-60-7449-8.</p>
<p>Wickham H. (2010) A Layered Grammar of Graphics. <em>Journal of Computational and Graphical Statistics</em> <strong>19:</strong> 3–28.</p>
<p>Wickham H. (2016) <em>ggplot2</em>. Springer International Publishing. ISBN 978-3-319-24275-0.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
